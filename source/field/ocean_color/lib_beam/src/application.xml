<?xml version="1.0" encoding="us-ascii"?>
<application xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" id="beam_arithm">
	<jobTemplates>
		<jobTemplate id="expression">
			<streamingExecutable>/application/expression/run</streamingExecutable>
			<defaultParameters>
				<parameter id="expression">l1_flags.INVALID?0:radiance_13>17?0:100+radiance_9-(radiance_8+(radiance_10-radiance_8)*27.524/72.570)</parameter>
				<parameter type="opensearch" target="time:start" id="startdate"/>
				<parameter type="opensearch" target="time:end" id="enddate"/>
				<parameter type="opensearch" target="geo:box" id="bbox"/>
			</defaultParameters>
			<defaultJobconf>
				<property id="mapred.task.timeout">9900000000000</property>
			</defaultJobconf>
		</jobTemplate>
		<jobTemplate id="arrange">
			<streamingExecutable>/application/arrange/run.R</streamingExecutable>
			<defaultParameters>
				<parameter id="period">day</parameter>
			</defaultParameters>
			<defaultJobconf>
				<property id="ciop.job.max.tasks">1</property>
			</defaultJobconf>
		</jobTemplate> 
		<jobTemplate id="binning">
			<streamingExecutable>/application/binning/run</streamingExecutable>
			<defaultParameters>						
				<parameter id="cellsize">9.28</parameter>
				<parameter id="bandname">out</parameter>
				<parameter id="bbox">-180,-90,180,90</parameter>
				<parameter id="algorithm">Minimum/Maximum</parameter>
			</defaultParameters>
			<defaultJobconf>
				<property id="mapred.task.timeout">9900000000000</property>
			</defaultJobconf>
		</jobTemplate> 
		<jobTemplate id="clustering">
			<streamingExecutable>/application/clustering/run.R</streamingExecutable>
			<defaultParameters>
				<parameter id="eps">10</parameter>
				<parameter id="minpts">10</parameter>
				<parameter id="threshold">100.5</parameter>
			</defaultParameters>
			<defaultJobconf>
				<property id="ciop.job.max.tasks">1</property>
			</defaultJobconf>
		</jobTemplate>
	</jobTemplates>
  <workflow id="beam_arithm" title="BEAM Arithm" abstract="This application detects algal blooms">
		<workflowVersion>1.0</workflowVersion>
		<node id="node_expression">
			<job id="expression" />
			<sources>
				<source refid="cas:series">http://localhost/catalogue/sandbox/MER_RR__1P/description</source>
			</sources>
			<parameters>
				<parameter type="opensearch" target="time:start" id="startdate">2012-04-02</parameter>
				<parameter type="opensearch" target="time:end" id="enddate">2012-04-06</parameter>
			</parameters>
		</node>
		<node id="node_arrange">				
			<job id="arrange"></job>			
			<sources>
				<source refid="wf:node">node_expression</source>				
			</sources>
			<parameters>
			</parameters>
		</node>
		<node id="node_binning">
			<job id="binning"></job>
			<sources>
				<source refid="wf:node">node_arrange</source>
			</sources>
			<parameters>
			</parameters>
		</node>
		<node id="node_clustering">
			<job id="clustering"></job>
			<sources>
				<source refid="wf:node">node_binning</source>
			</sources>
			<parameters>
			</parameters>
		</node>
	</workflow>
</application>
